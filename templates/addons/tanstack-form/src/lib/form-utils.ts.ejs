<% if (hasAddon('zod')) { -%>
import { z } from 'zod';

/**
 * Common validation schemas
 */
export const emailSchema = z.string().email('Invalid email address');
export const requiredString = z.string().min(1, 'This field is required');
export const optionalString = z.string().optional();

/**
 * Contact form validation schema
 */
export const contactFormSchema = z.object({
  name: requiredString,
  email: emailSchema,
  message: z.string().min(10, 'Message must be at least 10 characters'),
});

export type ContactFormData = z.infer<typeof contactFormSchema>;

/**
 * Validate a value against a Zod schema
 * Returns error message or undefined if valid
 */
export function validateWithZod<T>(
  schema: z.ZodType<T>,
  value: unknown
): string | undefined {
  const result = schema.safeParse(value);
  if (!result.success) {
    return result.error.errors[0]?.message;
  }
  return undefined;
}
<% } else { -%>
/**
 * Simple validation helpers
 */
export function isRequired(value: string): string | undefined {
  return value.trim() ? undefined : 'This field is required';
}

export function isEmail(value: string): string | undefined {
  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
  return emailRegex.test(value) ? undefined : 'Invalid email address';
}

export function minLength(min: number) {
  return (value: string): string | undefined => {
    return value.length >= min
      ? undefined
      : `Must be at least ${min} characters`;
  };
}

/**
 * Compose multiple validators
 */
export function compose(
  ...validators: Array<(value: string) => string | undefined>
) {
  return (value: string): string | undefined => {
    for (const validator of validators) {
      const error = validator(value);
      if (error) return error;
    }
    return undefined;
  };
}
<% } -%>
